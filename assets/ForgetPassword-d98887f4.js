import{aD as Y,v as ee,h as l,G as te,E as A,q as ne,aa as se,ab as oe,aE as ae,j as e,w as re,x as ie,y as le,a as ue,u as ce,b as de,c as pe,d as S,F as xe,V as q,W as N,T as U,a0 as fe,i as ge,B as he,ax as me,aF as Ce,m as Ie,aG as Pe,s as k,aH as je}from"./index-8ff37333.js";import{u as ve}from"./index-ff5337d8.js";import{H as ye}from"./chunk-7OLJDQMT-8574f9ef.js";import{F as be}from"./chunk-7COXQURZ-f9645faf.js";var[we,He,Fe,Ee]=Y(),[Ae,Se]=ee({name:"PinInputContext",errorMessage:"usePinInputContext: `context` is undefined. Seems you forgot to all pin input fields within `<PinInput />`"}),W=s=>s==null?void 0:s.split("");function X(s,r){return(r==="alphanumeric"?/^[a-zA-Z0-9]+$/i:/^[0-9]+$/).test(s)}function Ne(s={}){const{autoFocus:r,value:c,defaultValue:i,onChange:p,onComplete:d,placeholder:C="â—‹",manageFocus:x=!0,otp:y=!1,id:b,isDisabled:u,isInvalid:f,type:P="number",mask:V}=s,K=l.useId(),R=b??`pin-input-${K}`,o=Fe(),[B,D]=l.useState(!0),[M,H]=l.useState(-1),[I,g]=ve({defaultValue:W(i)||[],value:W(c),onChange:n=>p==null?void 0:p(n.join(""))});l.useEffect(()=>{if(r){const n=o.first();n&&requestAnimationFrame(()=>{n.node.focus()})}},[o]);const G=l.useCallback(n=>{if(!B||!x)return;const t=o.next(n,!1);t&&requestAnimationFrame(()=>{t.node.focus()})},[o,B,x]),j=l.useCallback((n,t,a=!0)=>{const h=[...I];h[t]=n,g(h),n!==""&&h.length===o.count()&&h.every(w=>w!=null&&w!=="")?d==null||d(h.join("")):a&&G(t)},[I,g,G,d,o]),O=l.useCallback(()=>{var n;const t=Array(o.count()).fill("");g(t);const a=o.first();(n=a==null?void 0:a.node)==null||n.focus()},[o,g]),L=l.useCallback((n,t)=>{let a=t;return(n==null?void 0:n.length)>0&&(n[0]===t.charAt(0)?a=t.charAt(1):n[0]===t.charAt(1)&&(a=t.charAt(0))),a},[]);return{getInputProps:l.useCallback(n=>{const{index:t,...a}=n,h=F=>{const m=F.target.value,E=I[t],_=L(E,m);if(_===""){j("",t);return}if(m.length>2){if(X(m,P)){const T=m.split("").filter((_e,Q)=>Q<o.count());g(T),T.length===o.count()&&(d==null||d(T.join("")))}}else X(_,P)&&j(_,t),D(!0)},$=F=>{var m;if(F.key==="Backspace"&&x)if(F.target.value===""){const E=o.prev(t,!1);E&&(j("",t-1,!1),(m=E.node)==null||m.focus(),D(!0))}else D(!1)},w=()=>{H(t)},Z=()=>{H(-1)},J=M===t;return{"aria-label":"Please enter your pin code",inputMode:P==="number"?"numeric":"text",type:V?"password":P==="number"?"tel":"text",...a,id:`${R}-${t}`,disabled:u,"aria-invalid":te(f),onChange:A(a.onChange,h),onKeyDown:A(a.onKeyDown,$),onFocus:A(a.onFocus,w),onBlur:A(a.onBlur,Z),value:I[t]||"",autoComplete:y?"one-time-code":"off",placeholder:J?"":C}},[o,M,L,R,u,V,f,x,d,y,C,j,g,P,I]),id:R,descendants:o,values:I,setValue:j,setValues:g,clear:O}}function ke(s={},r=null){const{getInputProps:c}=Se(),{index:i,register:p}=Ee();return c({...s,ref:ne(p,r),index:i})}function z(s){const r=se("PinInput",s),{children:c,...i}=oe(s),{descendants:p,...d}=Ne(i),C=ae(c).map(x=>l.cloneElement(x,{__css:r}));return e.jsx(we,{value:p,children:e.jsx(Ae,{value:d,children:C})})}z.displayName="PinInput";var v=re(function(r,c){const i=ke(r,c);return e.jsx(ie.input,{...i,className:le("chakra-pin-input",r.className)})});v.displayName="PinInputField";function Ge(){const s=ue(),r=ce(),c=de(),[i,p]=l.useState(""),[d,C]=l.useState(null),x=pe(u=>u.auth.resetemail),y=u=>{C(u)},b=async()=>{if(Ce("otp")===d)try{let f=await Ie.post("/auth/resetpassword",{data:{email:x,password:i}});r(Pe()),k(s,f.data,"success"),je.remove("otp"),c("/login")}catch(f){k(s,f.response.data.message?f.response.data.message:"Something Went Wrong","error")}else i===""?k(s,"Enter New Password","error"):k(s,"OTP Is Incorrect","error")};return e.jsxs(e.Fragment,{children:[e.jsx(S,{marginTop:["-10px","-20px","-30px","-40px","-40px"]}),e.jsx(xe,{minH:"92.5vh",align:"center",justify:"center",bg:q("gray.50","gray.800"),children:e.jsxs(N,{spacing:8,mx:"auto",maxW:"lg",py:12,px:6,children:[e.jsxs(N,{align:"center",children:[e.jsx(ye,{fontSize:"4xl",children:"Enter New Password"}),e.jsx(U,{fontSize:"lg",color:"gray.600",children:"Please enter the OTP that was sent to your email."})]}),e.jsx(S,{rounded:"lg",bg:q("white","gray.700"),boxShadow:"lg",p:8,children:e.jsxs(N,{spacing:4,children:[e.jsxs(fe,{id:"password",isRequired:!0,children:[e.jsx(be,{children:"Enter New Password"}),e.jsx(ge,{value:i,onChange:u=>p(u.target.value),type:"text"})]}),e.jsxs(N,{direction:"row",spacing:10,children:[e.jsxs(z,{otp:!0,onChange:u=>y(u),children:[e.jsx(v,{}),e.jsx(v,{}),e.jsx(v,{}),e.jsx(v,{})]}),e.jsx(he,{bg:"blue.400",color:"white",bgColor:"rgb(0,0,0)",_hover:{boxShadow:"xl"},onClick:b,children:"Submit"})]}),e.jsxs(S,{justifyContent:"center",alignItems:"center",display:"flex",mt:2,children:["Return to"," ",e.jsx(me,{to:"/login",children:e.jsx(U,{ml:1,textDecorationLine:"underline",color:"blue.400",children:"login"})})]})]})})]})}),e.jsx(S,{marginTop:["-10px","-20px","-30px","-40px","-40px"]})]})}export{Ge as default};
